# GitHub Actions workflow to deploy the static site to GitHub Pages.
# Places site content on the `gh-pages` branch using peaceiris/actions-gh-pages.
# WARNING: Do NOT write your real API key into the built files unless you understand
# the key will be public. If you need AI features, prefer using a server-side proxy.

name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      # OPTIONAL: create api-key.js from secret (UNSAFE: will expose key in built site).
      # Uncomment the following step ONLY if you accept that the key will be present
      # in the published site and the secret is rotatable.
      # - name: Create api-key.js from secret (UNSAFE)
      #   env:
      #     GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
      #   run: |
      #     if [ -n "$GEMINI_API_KEY" ]; then
      #       echo "// DO NOT COMMIT - generated by CI" > api-key.js
      #       echo "const GEMINI_API_KEY = '$GEMINI_API_KEY';" >> api-key.js
      #     fi

      - name: Deploy to gh-pages
        uses: peaceiris/actions-gh-pages@v4
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./
          publish_branch: gh-pages
          # If you only want to publish files under a specific folder (e.g., 'dist'), change publish_dir

# Notes:
# - This workflow publishes the repo root to the gh-pages branch. If your site needs a build step,
#   add build commands (npm install, npm run build) and change `publish_dir` to the build output.
# - Recommended: Do not inject secrets into the static build. Instead, implement a small proxy
#   (serverless or hosted) that keeps the Gemini API key private and call that from the frontend.
